<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/ETL-RDF-STAR/debug_pyoxigraph.py">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/ETL-RDF-STAR/debug_pyoxigraph.py" />
              <option name="updatedContent" value="&quot;&quot;&quot;&#10;Debug script to understand PyOxigraph QuerySolution behavior&#10;&quot;&quot;&quot;&#10;from pyoxigraph import Store, RdfFormat&#10;&#10;# Load small sample&#10;store = Store()&#10;&#10;print(&quot;Loading data...&quot;)&#10;with open(&quot;output/output_data_star.trig&quot;, 'rb') as f:&#10;    store.load(f, RdfFormat.TRIG)&#10;&#10;print(f&quot;Loaded {len(list(store))} quads\n&quot;)&#10;&#10;# Test query&#10;query = &quot;&quot;&quot;&#10;PREFIX dcat: &lt;http://www.w3.org/ns/dcat#&gt;&#10;PREFIX dct: &lt;http://purl.org/dc/terms/&gt;&#10;&#10;SELECT ?dataset ?title&#10;WHERE {&#10;    ?dataset a dcat:Dataset ;&#10;             dct:title ?title .&#10;}&#10;LIMIT 3&#10;&quot;&quot;&quot;&#10;&#10;print(&quot;Executing query...&quot;)&#10;results = list(store.query(query))&#10;print(f&quot;Got {len(results)} results\n&quot;)&#10;&#10;if results:&#10;    first = results[0]&#10;    &#10;    print(f&quot;Type of result: {type(first)}&quot;)&#10;    print(f&quot;Result repr: {repr(first)}&quot;)&#10;    print(f&quot;Result str: {str(first)}&quot;)&#10;    &#10;    print(&quot;\n--- Testing dictionary access ---&quot;)&#10;    try:&#10;        dataset = first['dataset']&#10;        print(f&quot;✓ first['dataset'] = {dataset}&quot;)&#10;        print(f&quot;  Type: {type(dataset)}&quot;)&#10;        print(f&quot;  Str: {str(dataset)}&quot;)&#10;    except Exception as e:&#10;        print(f&quot;✗ Dictionary access failed: {e}&quot;)&#10;    &#10;    print(&quot;\n--- Testing iteration ---&quot;)&#10;    try:&#10;        print(&quot;Iterating over result:&quot;)&#10;        for item in first:&#10;            print(f&quot;  Item: {item} (type: {type(item)})&quot;)&#10;    except Exception as e:&#10;        print(f&quot;✗ Iteration failed: {e}&quot;)&#10;    &#10;    print(&quot;\n--- Testing dir() ---&quot;)&#10;    methods = [m for m in dir(first) if not m.startswith('_')]&#10;    print(f&quot;Available methods: {methods}&quot;)&#10;    &#10;    print(&quot;\n--- Trying different access methods ---&quot;)&#10;    &#10;    # Try __iter__&#10;    try:&#10;        print(&quot;Using __iter__:&quot;)&#10;        for var in first:&#10;            print(f&quot;  Variable: {var}&quot;)&#10;            value = first[var]&#10;            print(f&quot;  Value: {value}&quot;)&#10;            print(f&quot;  Value type: {type(value)}&quot;)&#10;            print(f&quot;  Value str: {str(value)}&quot;)&#10;    except Exception as e:&#10;        print(f&quot;✗ __iter__ failed: {e}&quot;)&#10;    &#10;    print(&quot;\n--- All results ---&quot;)&#10;    for i, result in enumerate(results):&#10;        print(f&quot;\nResult {i+1}:&quot;)&#10;        try:&#10;            for var in result:&#10;                value = result[var]&#10;                print(f&quot;  {var} = {value}&quot;)&#10;        except Exception as e:&#10;            print(f&quot;  Error: {e}&quot;)&#10;&#10;else:&#10;    print(&quot;No results returned!&quot;)&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/ETL-RDF-STAR/debug_pyoxigraph2.py">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/ETL-RDF-STAR/debug_pyoxigraph2.py" />
              <option name="originalContent" value="&#10;" />
              <option name="updatedContent" value="&quot;&quot;&quot;&#10;Find how to get variable names from QuerySolutions&#10;&quot;&quot;&quot;&#10;from pyoxigraph import Store, RdfFormat&#10;&#10;store = Store()&#10;with open(&quot;output/output_data_star.trig&quot;, 'rb') as f:&#10;    store.load(f, RdfFormat.TRIG)&#10;&#10;query = &quot;&quot;&quot;&#10;PREFIX dcat: &lt;http://www.w3.org/ns/dcat#&gt;&#10;PREFIX dct: &lt;http://purl.org/dc/terms/&gt;&#10;&#10;SELECT ?dataset ?title ?issued&#10;WHERE {&#10;    ?dataset a dcat:Dataset ;&#10;             dct:title ?title ;&#10;             dct:issued ?issued .&#10;}&#10;LIMIT 3&#10;&quot;&quot;&quot;&#10;&#10;print(&quot;Executing query...&quot;)&#10;query_results = store.query(query)&#10;&#10;print(f&quot;Type of query_results: {type(query_results)}&quot;)&#10;print(f&quot;Query results: {query_results}&quot;)&#10;&#10;# Check if it has variables method&#10;print(f&quot;\ndir(query_results): {[m for m in dir(query_results) if not m.startswith('_')]}&quot;)&#10;&#10;# Try to get variables&#10;if hasattr(query_results, 'variables'):&#10;    print(f&quot;\n✓ Has .variables property!&quot;)&#10;    vars = query_results.variables  # Property, not method!&#10;    print(f&quot;Variables: {vars}&quot;)&#10;    print(f&quot;Variable types: {[type(v) for v in vars]}&quot;)&#10;    print(f&quot;Variable strings: {[str(v) for v in vars]}&quot;)&#10;&#10;# Convert to list and try first result&#10;results_list = list(query_results)&#10;print(f&quot;\nGot {len(results_list)} results&quot;)&#10;&#10;if results_list:&#10;    first = results_list[0]&#10;    print(f&quot;\nFirst result type: {type(first)}&quot;)&#10;&#10;    # Try accessing by string&#10;    print(&quot;\n--- Access by string key ---&quot;)&#10;    for var_name in ['dataset', 'title', 'issued']:&#10;        try:&#10;            value = first[var_name]&#10;            print(f&quot;✓ first['{var_name}'] = {value}&quot;)&#10;        except Exception as e:&#10;            print(f&quot;✗ first['{var_name}'] failed: {e}&quot;)&#10;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/ETL-RDF-STAR/test_fix.py">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/ETL-RDF-STAR/test_fix.py" />
              <option name="updatedContent" value="&quot;&quot;&quot;&#10;Test the fixed FastAPI server locally without running uvicorn&#10;&quot;&quot;&quot;&#10;from pyoxigraph import Store, RdfFormat&#10;import json&#10;&#10;# Load data&#10;print(&quot;Loading data...&quot;)&#10;store = Store()&#10;with open(&quot;ontology/data_products_ontology.ttl&quot;, 'rb') as f:&#10;    store.load(f, RdfFormat.TURTLE)&#10;with open(&quot;output/output_data_star.trig&quot;, 'rb') as f:&#10;    store.load(f, RdfFormat.TRIG)&#10;&#10;print(f&quot;Loaded {len(list(store)):,} quads\n&quot;)&#10;&#10;# Test query&#10;query = &quot;&quot;&quot;&#10;PREFIX dcat: &lt;http://www.w3.org/ns/dcat#&gt;&#10;PREFIX dct: &lt;http://purl.org/dc/terms/&gt;&#10;&#10;SELECT ?dataset ?title ?issued&#10;WHERE {&#10;    ?dataset a dcat:Dataset ;&#10;             dct:title ?title ;&#10;             dct:issued ?issued .&#10;}&#10;LIMIT 5&#10;&quot;&quot;&quot;&#10;&#10;print(&quot;Executing query...&quot;)&#10;query_results = store.query(query)&#10;&#10;# Get variables BEFORE converting to list&#10;vars = []&#10;if hasattr(query_results, 'variables'):&#10;    var_objects = query_results.variables&#10;    vars = [str(v).lstrip('?') for v in var_objects]&#10;    print(f&quot;✓ Variables: {vars}\n&quot;)&#10;&#10;# Convert to list&#10;results = list(query_results)&#10;print(f&quot;✓ Got {len(results)} results\n&quot;)&#10;&#10;# Convert to bindings&#10;bindings = []&#10;for result in results:&#10;    binding = {}&#10;    for var in vars:&#10;        try:&#10;            value = result[var]&#10;            if value is not None:&#10;                value_str = str(value)&#10;                if value_str.startswith('&lt;') and value_str.endswith('&gt;'):&#10;                    binding[var] = {'type': 'uri', 'value': value_str[1:-1]}&#10;                elif value_str.startswith('&quot;'):&#10;                    if '^^' in value_str:&#10;                        parts = value_str.split('^^')&#10;                        binding[var] = {&#10;                            'type': 'literal',&#10;                            'value': parts[0].strip('&quot;'),&#10;                            'datatype': parts[1].strip('&lt;&gt;')&#10;                        }&#10;                    else:&#10;                        binding[var] = {'type': 'literal', 'value': value_str.strip('&quot;')}&#10;                else:&#10;                    binding[var] = {'type': 'literal', 'value': value_str}&#10;        except KeyError:&#10;            continue&#10;    bindings.append(binding)&#10;&#10;# Display results&#10;response = {&#10;    'head': {'vars': vars},&#10;    'results': {'bindings': bindings}&#10;}&#10;&#10;print(&quot;=&quot;*80)&#10;print(&quot;RESULT:&quot;)&#10;print(&quot;=&quot;*80)&#10;print(json.dumps(response, indent=2))&#10;&#10;print(&quot;\n&quot; + &quot;=&quot;*80)&#10;print(&quot;VERIFICATION:&quot;)&#10;print(&quot;=&quot;*80)&#10;for i, binding in enumerate(bindings, 1):&#10;    print(f&quot;\n{i}. Dataset: {binding.get('dataset', {}).get('value', 'N/A')}&quot;)&#10;    print(f&quot;   Title: {binding.get('title', {}).get('value', 'N/A')}&quot;)&#10;    print(f&quot;   Issued: {binding.get('issued', {}).get('value', 'N/A')}&quot;)&#10;&#10;print(&quot;\n✅ SUCCESS! Bindings are no longer empty!&quot;)&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>